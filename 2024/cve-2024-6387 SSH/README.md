# cve-2024-6387-poc
a signal handler race condition in OpenSSH's server (sshd)

**漏洞描述**

OpenSSH 远程代码执行漏洞(CVE-2024-6387)，该漏洞是由于OpenSSH服务器 (sshd) 中的信号处理程序竞争问题，未经身份验证的攻击者可以利用此漏洞在Linux系统上以root身份执行任意代码。

受影响版本8.5p1 <= OpenSSH < 9.8p1

**空间测绘**

测绘语法：

```yaml
Fofa：protocol="ssh"
quake：app:"OpenSSH"
hunter：app.name="OpenSSH"
```

**漏洞复现**

使用gcc编译源码，该漏洞攻击时间过长，在本地虚拟机环境“平均需要尝试约10,000次才能成功，约需3-4小时，每次实验成功率只有一半，因此平均需要6-8小时才能获得远程root shell

```yaml
gcc -o exploit 7etsuo-regreSSHion.c
./exploit <ip> <port>
例如：
./exploit 192.168.31.19 22
```

**修复意见**

1、使用未受影响的应用版本。 

2、关注官方发布的补丁。 

3、设置白名单访问。
