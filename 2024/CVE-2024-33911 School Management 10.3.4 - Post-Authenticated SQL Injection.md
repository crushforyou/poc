# 漏洞描述

由 Weblizar 为 WordPress 开发的 School Management 插件 10.3.4 版容易受到 /wp-admin/admin-ajax.php 端点中的“order%5B0%5D%5Bdir%5D”参数的身份验证后 SQL 注入攻击。此漏洞是由于用户提供的参数的转义不充分以及缺乏对 SQL 查询的正确准备所致。此类漏洞允许经过身份验证的攻击者注入并执行任意 SQL 命令，这可能导致未经授权访问或操纵数据库信息。

# 受影响的组件



- **插件：**The School Management
- **版本：** 10.3.4
- **受影响的参数：**'订单%5B0%5D%5Bdir%5D'
- **受影响的终结点：**/wp-admin/admin-ajax.php

# 描述

该漏洞位于管理 AJAX 终结点内的“order%5B0%5D%5Bdir%5D”参数中。通过操纵此参数，经过身份验证的攻击者可以注入 SQL 命令，从而导致基于时间的 SQL 注入漏洞。

# 验证

```yaml
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: localhost
[Additional Headers]
draw=3&[Other Parameters]&order%5B0%5D%5Bdir%5D=asc%2c(select*from(select(sleep(20)))a)
```

# 修复

强烈建议 The School Management v10.3.4 的用户限制对受影响端点的访问，并将插件更新到最新版本。此外，实施正确的输入验证和清理检查也至关重要。使用预准备语句或参数化查询来处理 SQL 命令有助于缓解此类漏洞。